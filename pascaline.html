<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Pascal‑style Mechanical Calculator Simulator</title>
  <style>
    :root {
      --bg: #ebe8e3;
      --panel-bg: #d9d4cd;
      --wheel-bg: #c2b29a;
      --wheel-border: #857556;
      --digit-color: #2a1f0f;
      --btn-bg: #857556;
      --btn-color: #f7f5f2;
      --btn-hover-bg: #9b8a72;
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      padding: 20px;
      font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      background: var(--bg);
      color: var(--digit-color);
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .lang-switch {
      margin-bottom: 1em;
    }
    .calculator {
      background: var(--panel-bg);
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
      max-width: 100%;
      width: 500px;
    }
    .inputs {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-bottom: 1em;
    }
    .inputs label {
      flex: 1 1 100px;
      display: flex;
      flex-direction: column;
      font-size: 0.9em;
    }
    .inputs input {
      padding: 6px;
      font-size: 1em;
    }
    .operation {
      margin-bottom: 1em;
      font-size: 0.95em;
    }
    .operation label {
      margin-right: 15px;
    }
    button {
      padding: 8px 16px;
      font-size: 1em;
      background: var(--btn-bg);
      color: var(--btn-color);
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }
    button:hover {
      background: var(--btn-hover-bg);
    }
    .wheels {
      margin: 20px 0;
      display: flex;
      justify-content: center;
      align-items: flex-end;
      height: 60px;
      flex-wrap: wrap;
    }
    .wheel {
      width: 36px;
      height: 48px;
      overflow: hidden;
      border: 3px solid var(--wheel-border);
      border-radius: 8px;
      margin: 0 4px;
      background: var(--wheel-bg);
      position: relative;
      box-shadow: inset 0 2px 6px rgba(0,0,0,0.2);
    }
    .digits {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      transition: transform 0.5s ease-in-out;
    }
    .digits div {
      height: 48px;
      line-height: 48px;
      text-align: center;
      font-size: 1.4em;
      color: var(--digit-color);
      user-select: none;
    }
    .history {
      margin-top: 2em;
      max-width: 600px;
      line-height: 1.5;
    }
    @media (max-width: 540px) {
      .calculator { width: 100%; }
      .wheel {
        width: 28px;
        margin: 0 2px;
      }
      .digits div {
        height: 36px;
        line-height: 36px;
        font-size: 1.2em;
      }
      .wheels {
        height: 48px;
      }
    }
  </style>
</head>
<body>

  <div class="lang-switch">
    <label for="langSelect">Language:</label>
    <select id="langSelect">
      <option value="en">English</option>
      <option value="de">Deutsch</option>
      <option value="es">Español</option>
    </select>
  </div>

  <div class="calculator">
    <div class="inputs">
      <label>
        <span id="labelA">A:</span>
        <input type="number" id="inputA" value="0">
      </label>
      <label>
        <span id="labelB">B:</span>
        <input type="number" id="inputB" value="0">
      </label>
    </div>

    <div class="operation">
      <label><input type="radio" name="op" value="add" checked> <span id="labelAdd">Add</span></label>
      <label><input type="radio" name="op" value="sub"> <span id="labelSub">Subtract</span></label>
    </div>

    <button id="computeBtn">Compute</button>

    <div class="wheels" id="wheelsContainer">
      <!-- wheels generated by JS -->
    </div>
  </div>

  <div class="history">
    <h2 id="historyTitle">About the Pascaline</h2>
    <p id="historyText"></p>
  </div>



  <script>
    // Translations
    const translations = {
      en: {
        labelA: 'A:',
        labelB: 'B:',
        labelAdd: 'Add',
        labelSub: 'Subtract',
        computeBtn: 'Compute',
        historyTitle: 'About the Pascaline',
        historyText:
          'The Pascaline was invented by Blaise Pascal in 1642 as the first mechanical calculator. ' +
          'It could perform addition and subtraction directly, using a system of interlocked wheels — ' +
          'each representing one digit. When one wheel turned from 9 ➝ 0, it triggered a carry into the next wheel, ' +
          'allowing multi‑digit arithmetic mechanically. Though primitive by modern standards, the Pascaline laid the foundation for all future calculating machines.'
      },
      de: {
        labelA: 'A:',
        labelB: 'B:',
        labelAdd: 'Addieren',
        labelSub: 'Subtrahieren',
        computeBtn: 'Berechnen',
        historyTitle: 'Über die Pascaline',
        historyText:
          'Die Pascaline wurde 1642 von Blaise Pascal erfunden und gilt als der erste mechanische Rechner. ' +
          'Sie konnte Additionen und Subtraktionen direkt ausführen, mithilfe eines Systems ineinandergreifender Räder – ' +
          'jedes stand für eine Ziffer. Wenn ein Rad von 9 ➝ 0 sprang, wurde eine „Übertragung” zum nächsten Rad ausgelöst, ' +
          'so dass auch mehrstellige Rechnungen mechanisch möglich waren. Für damalige Verhältnisse revolutionär — ' +
          'die Pascaline legte den Grundstein aller späteren Rechenmaschinen.'
      },
      es: {
        labelA: 'A:',
        labelB: 'B:',
        labelAdd: 'Sumar',
        labelSub: 'Restar',
        computeBtn: 'Calcular',
        historyTitle: 'Sobre la Pascalina',
        historyText:
          'La Pascalina fue inventada por Blaise Pascal en 1642 y es considerada la primera calculadora mecánica. ' +
          'Podía realizar sumas y restas directamente, mediante un sistema de ruedas interconectadas — ' +
          'cada una representando una cifra. Cuando una rueda giraba de 9 ➝ 0, se producía una “acarreo” hacia la rueda siguiente, ' +
          'permitiendo cálculos multi‑dígito de forma mecánica. Aunque era rudimentaria comparada a los estándares modernos, ' +
          'la Pascalina sentó las bases de todas las futuras máquinas de cálculo.'
      }
    };
    let currentLang = 'en';

    function updateLanguage(lang) {
      currentLang = lang;
      const t = translations[lang];
      document.getElementById('labelA').textContent = t.labelA;
      document.getElementById('labelB').textContent = t.labelB;
      document.getElementById('labelAdd').textContent = t.labelAdd;
      document.getElementById('labelSub').textContent = t.labelSub;
      document.getElementById('computeBtn').textContent = t.computeBtn;
      document.getElementById('historyTitle').textContent = t.historyTitle;
      document.getElementById('historyText').textContent = t.historyText;
    }

    document.getElementById('langSelect').addEventListener('change', e => {
      updateLanguage(e.target.value);
    });

    // Wheels setup
    const NUM_WHEELS = 6;  // max 6 digits
    const wheelsContainer = document.getElementById('wheelsContainer');
    const wheelDigits = [];  // will store <div class="digits"> for each wheel

    function createWheels() {
      for (let i = 0; i < NUM_WHEELS; i++) {
        const wheel = document.createElement('div');
        wheel.className = 'wheel';
        const digits = document.createElement('div');
        digits.className = 'digits';
        for (let d = 0; d <= 9; d++) {
          const dv = document.createElement('div');
          dv.textContent = d;
          digits.appendChild(dv);
        }
        wheel.appendChild(digits);
        wheelsContainer.appendChild(wheel);
        wheelDigits.push(digits);
      }
    }

    function getCurrentDigits() {
      return wheelDigits.map(digDiv => {
        const style = getComputedStyle(digDiv);
        const matrix = style.transform || '';
        const match = matrix.match(/translateY\(-?(\d+)px\)/);
        if (match) {
          const offset = parseInt(match[1], 10);
          const digitHeight = digDiv.children[0].offsetHeight;
          const d = Math.round(offset / digitHeight);
          return d;
        }
        return 0;
      });
    }

    function playClickSound() {
      if (!window.AudioContext) return;
      const ctx = new (window.AudioContext || window.webkitAudioContext)();
      const osc = ctx.createOscillator();
      const gain = ctx.createGain();
      osc.type = 'square';
      osc.frequency.value = 220;
      gain.gain.value = 0.1;
      osc.connect(gain);
      gain.connect(ctx.destination);
      osc.start();
      setTimeout(() => {
        osc.stop();
        ctx.close();
      }, 50);
    }

    function animateToDigits(targetDigits) {
      // Implements a simple mechanical-carry style animation
      let carry = 0;
      const height = wheelDigits[0].children[0].offsetHeight;
      function animateWheel(idx) {
        if (idx < 0) return;
        const digitsDiv = wheelDigits[idx];
        const current = getCurrentDigits()[idx];
        let target = targetDigits[idx] + carry;
        carry = 0;
        if (target > 9) {
          target -= 10;
          carry = 1;
        }
        digitsDiv.style.transition = 'transform 0.4s ease-in-out';
        digitsDiv.style.transform = `translateY(-${target * height}px)`;
        playClickSound();
        setTimeout(() => {
          animateWheel(idx - 1);
        }, 220);
      }
      animateWheel(NUM_WHEELS - 1);
    }

    function setWheelsInstant(num) {
      const s = String(num).padStart(NUM_WHEELS, '0');
      for (let i = 0; i < NUM_WHEELS; i++) {
        const d = parseInt(s.charAt(i), 10);
        const div = wheelDigits[i];
        div.style.transition = 'none';
        const height = div.children[0].offsetHeight;
        div.style.transform = `translateY(-${d * height}px)`;
      }
    }

    function compute() {
      const a = parseInt(document.getElementById('inputA').value, 10) || 0;
      const b = parseInt(document.getElementById('inputB').value, 10) || 0;
      const op = document.querySelector('input[name="op"]:checked').value;
      let result = op === 'add' ? a + b : a - b;
      if (result < 0) {
        const msgs = {
          en: 'Negative result not supported.',
          de: 'Negatives Ergebnis nicht unterstützt.',
          es: 'Resultado negativo no soportado.'
        };
        alert(msgs[currentLang]);
        return;
      }
      const max = Math.pow(10, NUM_WHEELS) - 1;
      if (result > max) {
        const msgs = {
          en: `Result too large (max ${max}).`,
          de: `Ergebnis zu groß (max ${max}).`,
          es: `Resultado demasiado grande (máx. ${max}).`
        };
        alert(msgs[currentLang]);
        return;
      }
      const s = String(result).padStart(NUM_WHEELS, '0');
      const digits = s.split('').map(d => parseInt(d, 10));
      animateToDigits(digits);
    }

    // init
    createWheels();
    setWheelsInstant(0);
    updateLanguage(currentLang);

    document.getElementById('computeBtn').addEventListener('click', compute);
  </script>

</body>
</html>